<?xml version="1.0" encoding="ISO-8859-1" ?>
<configuration>
    <agent>
        <namespace>ha-cluster</namespace>
        <instance>edits-reader</instance>
        <hadoop>
            <home>/opt/hadoop</home>
            <config>src/test/resources/hdfs-site.xml</config>
        </hadoop>
        <editsReader>true</editsReader>
        <connections>
            <path>config</path>
            <hdfs-admin>source-hdfs</hdfs-admin>
        </connections>
        <state>
            <manager>
                <module>NameNodeAgent</module>
                <basePath>/hcdc/state</basePath>
                <connection>zk-state-connection</connection>
            </manager>
        </state>
        <useSSL>false</useSSL>
        <processor>
            <edits>
                <sender>
                    <connectionType>kafka</connectionType>
                    <connection>edits-kafka-queue</connection>
                    <topic>ha-cluster-edits</topic>
                    <!--partitioner></partitioner-->
                </sender>
                <pollingInterval>120000</pollingInterval>
            </edits>
        </processor>
        <locks>
            <lock>
                <name>global</name>
                <connection>zk-state-connection</connection>
                <lock-node>NN-GLOBAL-LOCK</lock-node>
            </lock>
            <lock>
                <name>replication</name>
                <connection>zk-state-connection</connection>
                <lock-node>NN-REPLICATION-LOCK</lock-node>
            </lock>
        </locks>
    </agent>
    <replicator>
        <connections>
            <hdfs>source-hdfs</hdfs>
        </connections>
    </replicator>
    <config>
        <connections>
            <connection>
                <type>ai.sapper.hcdc.core.connections.HdfsConnection</type>
                <hdfs>
                    <name>source-hdfs</name>
                    <namenode>
                        <primary>
                            <URI>hdfs://192.168.0.2:9000</URI>
                        </primary>
                        <secondary>
                            <URI>hdfs://192.168.0.3:9000</URI>
                        </secondary>
                    </namenode>
                    <security>
                        <enabled>false</enabled>
                    </security>
                    <enableAdmin>true</enableAdmin>
                </hdfs>
            </connection>
            <connection>
                <type>ai.sapper.hcdc.core.connections.HdfsHAConnection</type>
                <hdfs_ha>
                    <name>source-hdfs-ha</name>
                    <nameservice>ha-cluster</nameservice>
                    <failoverProvider>org.apache.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider
                    </failoverProvider>
                    <namenodes>nn1=192.168.0.2:9000;nn2=192.168.0.3:9000</namenodes>
                    <security>
                        <enabled>false</enabled>
                    </security>
                    <enableAdmin>true</enableAdmin>
                </hdfs_ha>
            </connection>
            <connection>
                <type>ai.sapper.hcdc.core.connections.ZookeeperConnection</type>
                <zookeeper>
                    <name>zk-state-connection</name>
                    <connectionString>192.168.0.5:2181,192.168.0.4:2181</connectionString>
                    <retry>
                        <interval>1500</interval>
                        <retries>5</retries>
                    </retry>
                    <connectionTimeout>10000</connectionTimeout>
                </zookeeper>
            </connection>
            <connection>
                <type>ai.sapper.hcdc.core.connections.impl.BasicKafkaProducer</type>
                <kafka>
                    <name>edits-kafka-queue</name>
                    <mode>Producer</mode>
                    <producer>
                        <config>src/test/resources/producer.properties</config>
                    </producer>
                    <topic>ha-cluster-edits</topic>
                </kafka>
            </connection>
            <!--connection>
                <type>ai.sapper.hcdc.core.connections.impl.BasicKafkaConsumer</type>
                <kafka>
                    <name>test-kafka-consumer</name>
                    <mode>Consumer</mode>
                    <config>
                        <consumer>src/test/resources/consumer.properties</consumer>
                        <topic>hcdc-test</topic>
                    </config>
                </kafka>
            </connection-->
        </connections>
    </config>
</configuration>